

# 데이먼 (daemon)
데이먼은 배경에서 실행되는 스레드를 뜻합니다. 파이썬에서는 프로그램이 끝나면 바로 끝나는 스레드를 뜻합니다. 만일 데이먼 스레드가 있다면 다른 스레드가 다 멈출 때까지 기다리고 바로 없어집니다. 다시 말하자면, 마지막으로 실행이 되는 스레드를 뜻합니다.

데이먼 스레드는 처음에 스레드를 만들 떼 선정을 할 수 있습니다.

```
mainThread = threading.Thread(target = mainFunc, daemon = True)
```

스레드가 데이먼 스레드인지 확인하는 방법은 daemon 키를 사용하는 방법이 있습니다.

```
mainThread = threading.Thread(target = mainFunc, daemon = True)
print(mainThread.daemon) # True가 출력됩니다
```

스레드를 나중에 데이먼으로 바꾸는 것도 가능하지만 스레드가 러닝하고 있으면 안 됩니다.

```
mainThread.setDaemon(True)
```

# 로킹
때로는 스레딩을 하며 값이 이상해질 때가 있습니다. 최신 컴퓨터는 더 좋아져서 스레드를 잘 다루지만 옛날 컴퓨터는 잘하지 못합니다.

```
import threading

def do_before():
  global x
  x = 0

  while ( x < 300):
    x+=1

  print(x)

def do_after():
  global x
  x = 450

  while (x < 700):
    x+=1

  print(x)

def main():
  global x
  x = 0

  main_thread = threading.Thread(target=do_before)
  main_thread.start()

  next_thread = threading.Thread(target=do_after)
  next_thread.start()


main()
```

그렇다면 어떻게 할까요?

비러 로크라는 것을 사용하면 됩니다. 가끔 스레드가 동시에 실행이 되는 바람에 global 한 변수가 이상해질 수 있습니다. 하지만 lock을 이용하면 변수의 값을 바꿀 때 에러 없이 작동시킬 수 있습니다.

```
import threading

lock = threading.Lock()

def do_before():
  global x, lock
  x = 0

  lock.acquire()

  try:
    while (x < 300):
      x += 1

    print(x)
  finally:
    lock.release()

def do_after():
  global x, lock
  x = 450

  lock.acquire()

  try:
    while (x < 700):
      x += 1

    print(x)
  finally:
    lock.release()

def main():
  global x, lock
  x = 0

  main_thread = threading.Thread(target=do_before)
  main_thread.start()

  next_thread = threading.Thread(target=do_after)
  next_thread.start()


main()
```

변수 값을 바꿀 때 전과 앞에 lock.aquire()과 lock.release() 메서드를 사용할 수 있습니다.
